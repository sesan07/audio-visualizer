<audio #audioElement [src]="audioConfig.src" (ended)="onEnded()"></audio>

<div class="visualizer-view"
     (click)="onVisualizerChange($event, null)">
    <ng-container *ngFor="let config of visualizerConfigs">
        <app-visualizer [config]="config"
                        [showOutline]="config === activeVisualizerConfig"
                        (click)="onVisualizerChange($event, config)">
        </app-visualizer>
    </ng-container>
</div>

<div class="control-view">
    <div class="control-group">
        <div class="media-controls">
            <button class="secondary-media-btn"
                    pButton pRipple
                    icon="pi pi-step-backward-alt"
                    (click)="onPrevSong()">
            </button>
            <button class="primary-media-btn"
                    pButton pRipple
                    [icon]="isPlaying ? 'pi pi-pause' : 'pi pi-play'"
                    (click)="onPlayPause()">
            </button>
            <button class="secondary-media-btn"
                    pButton pRipple
                    icon="pi pi-step-forward-alt"
                    (click)="onNextSong()">
            </button>
        </div>
        <p-dropdown class="song-select" [options]="audioConfigs"
                    [(ngModel)]="audioConfig"
                    placeholder="Select a Song"
                    optionLabel="src">
        </p-dropdown>
    </div>
    <div class="control-group">
        <div class="control-wrapper">
            <span>Add Visualizer</span>
            <span>
                    <p-dropdown [options]="addOptions"
                                [(ngModel)]="selectedAddOption"
                                placeholder="Select an option">
                    </p-dropdown>
                    <button class="add-btn" pButton pRipple label="Add" (click)="onAddClicked()"></button>
                </span>
        </div>

        <div class="control-wrapper">
            <span>Mode</span>
            <p-selectButton [options]="modeOptions"
                            [(ngModel)]="mode"
                            (onChange)="onModeChanged()"
                            optionLabel="name"
                            optionValue="value">
            </p-selectButton>
        </div>

        <div class="control-wrapper">
            <span>Decibel Range</span>
            <div class="slider-wrapper">
                <span>{{decibelRange[0]}}</span>
                <p-slider [(ngModel)]="decibelRange"
                          (onChange)="onDecibelChanged()"
                          [min]="-100"
                          [max]="0"
                          [range]="true">
                </p-slider>
                <span>{{decibelRange[1]}}</span>
            </div>
        </div>

        <div class="control-wrapper">
            <span>Samples</span>
            <p-dropdown [options]="sampleCountOptions"
                        [(ngModel)]="sampleCount"
                        (onChange)="onSampleCountChanged()"
                        placeholder="Select an option">
            </p-dropdown>
        </div>
    </div>
    <app-visualizer-controller class="control-group"
                               *ngIf="activeVisualizerConfig"
                               [config]="activeVisualizerConfig"
                               (remove)="onRemoveVisualizer()">
    </app-visualizer-controller>
</div>

