<audio #audioElement [src]="selectedAudioConfig.src" (ended)="onEnded()"></audio>

<div class="visualizer-view"
     (click)="onVisualizerChange($event, null)">
    <ng-container *ngFor="let visualizer of visualizers">
        <app-visualizer [config]="visualizer"
                        [showOutline]="visualizer === activeVisualizer"
                        (click)="onVisualizerChange($event, visualizer)">
        </app-visualizer>
    </ng-container>
</div>

<div class="control-view">
    <div class="card control-group main-controls">
        <div class="media-controls">
            <button class="secondary-media-btn" nz-button nzShape="circle" (click)="onPrevSong()">
                <i nz-icon nzType="step-backward"></i>
            </button>
            <button class="primary-media-btn" nz-button nzType="primary" nzShape="circle" (click)="onPlayPause()">
                <i nz-icon [nzType]="isPlaying ? 'pause' : 'caret-right'"></i>
            </button>
            <button class="secondary-media-btn" nz-button nzShape="circle" (click)="onNextSong()">
                <i nz-icon nzType="step-forward"></i>
            </button>
        </div>

        <button nz-button nz-dropdown [nzDropdownMenu]="audioMenu">
            Current Song: {{getAudioName(selectedAudioConfig.src)}}
            <i nz-icon nzType="down"></i>
        </button>
        <nz-dropdown-menu #audioMenu="nzDropdownMenu">
            <ul nz-menu nzSelectable>
                <li *ngFor="let option of audioConfigOptions" nz-menu-item (click)="selectedAudioConfig = option">{{getAudioName(option.src)}}</li>
            </ul>
        </nz-dropdown-menu>

        <nz-button-group>
            <button nz-button (click)="onAddClicked()">Add {{selectedAddVisualizer}} Visualizer</button>
            <button nz-button nz-dropdown [nzDropdownMenu]="visualizerMenu" nzPlacement="bottomRight" >
                <i nz-icon nzType="ellipsis"></i>
            </button>
            <nz-dropdown-menu #visualizerMenu="nzDropdownMenu">
                <ul nz-menu nzSelectable>
                    <li *ngFor="let option of addVisualizerOptions" nz-menu-item (click)="selectedAddVisualizer = option">{{option}}</li>
                </ul>
            </nz-dropdown-menu>
        </nz-button-group>
    </div>
    <app-visualizer-controller class="card control-group"
                               *ngIf="activeVisualizer"
                               [config]="activeVisualizer"
                               (remove)="onRemoveVisualizer()">
    </app-visualizer-controller>
</div>

