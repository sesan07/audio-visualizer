<nz-collapse>
    <nz-collapse-panel nzHeader="Entity Options">
        <app-control-line name="Entity Type">
            <nz-radio-group [ngModel]="config.type" (ngModelChange)="onEntityTypeChange($event)">
                <label *ngFor="let option of entityTypeOptions" nz-radio-button [nzValue]="option">{{option}}</label>
            </nz-radio-group>
        </app-control-line>

        <app-control-line name="Name" *ngIf="!config.isEmitted">
            <span class="name-edit-text">{{config.name}}</span>
            <button nz-button
                    nz-popover
                    nzPopoverTitle="Edit Name"
                    nzPopoverTrigger="click"
                    [(nzPopoverVisible)]="nameEditPopOverVisible"
                    [nzPopoverContent]="nameEditTemplate">
                <i nz-icon nzType="edit"></i>
            </button>
            <ng-template #nameEditTemplate>
                <input #nameEditInput nz-input placeholder="Entity Name" [ngModel]="config.name"/>
                <span class="popover-action-buttons">
                    <button nz-button nzDanger (click)="nameEditPopOverVisible = false">
                        <i nz-icon nzType="close"></i>
                    </button>
                    <button nz-button nzType="primary" (click)="config.name = nameEditInput.value; nameEditPopOverVisible = false">
                        <i nz-icon nzType="check"></i>
                    </button>
                </span>
            </ng-template>
        </app-control-line>

        <app-control-line name="Opacity">
            <nz-input-number [(ngModel)]="config.opacity" [nzStep]="0.1" [nzMin]="0" [nzMax]="1"></nz-input-number>
            <nz-slider [(ngModel)]="config.opacity" [nzStep]="0.1" [nzMin]="0" [nzMax]="1"></nz-slider>
        </app-control-line>

        <app-control-line name="Base Scale">
            <nz-input-number [(ngModel)]="config.scale" [nzStep]="0.05" [nzMin]="0" [nzMax]="2" (ngModelChange)="onDimensionsChange()"></nz-input-number>
            <nz-slider [(ngModel)]="config.scale" [nzStep]="0.05" [nzMin]="0" [nzMax]="2" (ngModelChange)="onDimensionsChange()"></nz-slider>
        </app-control-line>

        <app-control-line name="Oomph Scale">
            <nz-input-number [(ngModel)]="config.oomphAmount" [nzStep]="0.1" [nzMin]="0" [nzMax]="10" (ngModelChange)="onDimensionsChange()"></nz-input-number>
            <nz-slider [(ngModel)]="config.oomphAmount" [nzStep]="0.1" [nzMin]="0" [nzMax]="10" (ngModelChange)="onDimensionsChange()"></nz-slider>
        </app-control-line>

        <app-control-line name="Fade In/Out Time" *ngIf="config.isEmitted">
            <nz-input-number [(ngModel)]="config.fadeTime" [nzStep]="0.1" [nzMin]="0" [nzMax]="5"></nz-input-number>
            <nz-slider [(ngModel)]="config.fadeTime" [nzStep]="0.1" [nzMin]="0" [nzMax]="5"></nz-slider>
        </app-control-line>

        <ng-container *ngIf="config.isEmitted">
            <app-control-line name="Animate Movement">
                <nz-switch [(ngModel)]="config.animateMovement"></nz-switch>
            </app-control-line>
            <app-control-line *ngIf="config.animateMovement" name="Random Movement">
                <nz-switch [(ngModel)]="config.randomizeMovement"></nz-switch>
            </app-control-line>
            <ng-container *ngIf="config.animateMovement && !config.randomizeMovement">
                <app-control-line name="Movement Angle">
                    <nz-input-number [(ngModel)]="config.movementAngle" [nzStep]="5" [nzMin]="0" [nzMax]="360"></nz-input-number>
                    <nz-slider [(ngModel)]="config.movementAngle" [nzStep]="5" [nzMin]="0" [nzMax]="360"></nz-slider>
                </app-control-line>
                <app-control-line name="Movement Speed">
                    <nz-input-number [(ngModel)]="config.movementSpeed" [nzStep]="0.1" [nzMin]="0.1" [nzMax]="5"></nz-input-number>
                    <nz-slider [(ngModel)]="config.movementSpeed" [nzStep]="0.1" [nzMin]="0.1" [nzMax]="5"></nz-slider>
                </app-control-line>
            </ng-container>
        </ng-container>

        <app-control-line name="Animate Rotation">
            <nz-switch [(ngModel)]="config.animateRotation"></nz-switch>
        </app-control-line>
        <ng-container *ngIf="config.animateRotation">
            <app-control-line name="Rotation Direction">
                <nz-radio-group [(ngModel)]="config.rotationDirection">
                    <label *ngFor="let option of ['Left', 'Right']" nz-radio-button [nzValue]="option">{{option}}</label>
                </nz-radio-group>
            </app-control-line>
            <app-control-line name="Rotation Speed">
                <nz-input-number [(ngModel)]="config.rotationSpeed" [nzStep]="0.1" [nzMin]="0.1" [nzMax]="5"></nz-input-number>
                <nz-slider [(ngModel)]="config.rotationSpeed" [nzStep]="0.1" [nzMin]="0.1" [nzMax]="5"></nz-slider>
            </app-control-line>
        </ng-container>
        <app-control-line *ngIf="!config.animateRotation" name="Rotation">
            <nz-input-number [ngModel]="config.rotation" [nzStep]="5" [nzMin]="0" [nzMax]="360"></nz-input-number>
            <nz-slider [(ngModel)]="config.rotation" [nzStep]="5" [nzMin]="0" [nzMax]="360"></nz-slider>
        </app-control-line>
    </nz-collapse-panel>
</nz-collapse>

<ng-container [ngSwitch]="config.type">
    <app-bar-controller *ngSwitchCase="EntityType.BAR" [entity]="config"></app-bar-controller>
    <app-barcle-controller *ngSwitchCase="EntityType.BARCLE" [entity]="config"></app-barcle-controller>
    <app-circle-controller *ngSwitchCase="EntityType.CIRCLE" [entity]="config"></app-circle-controller>
    <app-image-controller *ngSwitchCase="EntityType.IMAGE" [entity]="config"></app-image-controller>
</ng-container>